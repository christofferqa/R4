{% extends "base.html" %}

{% block content %}

<h2><a href="../index.html">R4</a>: {{ website }}</h2>

 <!-- Nav tabs -->
<ul class="nav nav-tabs">
  <li class="active"><a href="#races" data-toggle="tab">Races</a></li>
  <li><a href="#erlog" data-toggle="tab">Event Racer Log</a></li>
</ul>

<!-- Tab panes -->
<div class="tab-content">
  <div class="tab-pane active" id="races">

    <table class="table">
        <tr>
            <th>Race</th>
            <th>Errors</th>
            <th>JS Exceptions</th>
            <th>HTML State Match</th>
            <th>Visual State Match</th>
            <th>Replay</th>
            <th>ERC</th>
            <th>R4C</th>
        </tr>

        {% for race in parsed_races %}
        <tr>
            <td>
                <a href="{{ race.handle }}.html">{{ race.handle }}</a>
            </td>
            <td class="{% if race.comparison.errors_diff_distance == 0 %}success{% else %}danger{% endif %}">
                {{ race.comparison.errors_diff_distance }}
            </td>
            <td class="{% if race.comparison.exceptions_diff_distance == 0 %}success{% else %}danger{% endif %}">
                {{ race.comparison.exceptions_diff_distance }}
            </td>
            <td class="{% if race.comparison.html_state_match %}success{% else %}danger{% endif %}">
                {{ race.comparison.html_state_match }}
            </td>
            <td class="{% if race.comparison.visual_state_match.human == 'EXACT' %}success{% else %}danger{% endif %}">
                {{ race.comparison.visual_state_match.human }} ({{ race.comparison.visual_state_match.distance }})
            </td>
            <td class="{% if race.race_data.result == 'FINISHED' %}success{% elif race.race_data.result == 'TIMEOUT' %}warning{% else %}danger{% endif %}">
                {{ race.race_data.result }}
            </td>
            <td>
              {{ race.race_data.er_classification }}{% if race.race_data.er_classification_details %}: <small><i>{{ race.race_data.er_classification_details }}</i></small>{% endif %}
            </td>
            <td>
              {{ race.comparison.r4_classification }}{% if race.comparison.r4_classification_details %}: <small><i>{{ race.comparison.r4_classification_details }}</i></small>{% endif %}
            </td>

        </tr>
        {% endfor %}

    </table>

  </div>

  <div class="tab-pane" id="erlog">

      <h3>Event Racer stdout</h3>

      <pre>{{ er_log.stdout }}</pre>

  </div>

</div>

{% endblock %}
